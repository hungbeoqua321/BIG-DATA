<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zero-Shot Depth-Aware Image Editing</title>
    <!-- Mermaid JS -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <style>
        /* RESET & BASE */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
            scroll-snap-type: y proximity;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f0f2f5;
        }

        /* ===== HEADER ===== */
        header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 1rem 0;
        }

        .header-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 800;
            color: #2c3e50;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
        }

        .logo span { color: #3498db; }

        nav ul {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        nav a {
            text-decoration: none;
            color: #555;
            font-weight: 600;
            position: relative;
            transition: color 0.3s;
        }

        nav a:hover, nav a.active { color: #3498db; }
        nav a::after {
            content: ''; position: absolute; bottom: -5px; left: 0; width: 0; height: 2px;
            background: #3498db; transition: width 0.3s;
        }
        nav a:hover::after { width: 100%; }

        /* Progress Bar */
        .progress-bar {
            position: fixed; top: 70px; left: 0; height: 3px;
            background: linear-gradient(90deg, #3498db, #8e44ad);
            z-index: 999; width: 0%; transition: width 0.2s;
        }

        /* ===== MAIN LAYOUT ===== */
        main { margin-top: 80px; }

        section {
            padding: 4rem 2rem; /* TƒÉng padding ƒë·ªÉ tho√°ng h∆°n */
            min-height: auto; /* Cho ph√©p chi·ªÅu cao t·ª± ƒë·ªông theo n·ªôi dung */
            display: flex;
            flex-direction: column;
            align-items: center;
            border-bottom: 1px solid #e1e1e1;
            scroll-snap-align: start;
            scroll-snap-stop: always;
        }

        .section-content { max-width: 1000px; width: 100%; }

        h2 {
            font-size: 2.5rem; color: #2c3e50; text-align: center; margin-bottom: 3rem;
            position: relative;
        }
        h2::after {
            content: ''; display: block; width: 60px; height: 4px;
            background: #3498db; margin: 1rem auto 0; border-radius: 2px;
        }

        /* ===== BOX STYLES ===== */
        .problem-box, .solution-box {
            padding: 2rem; border-radius: 12px; margin-bottom: 1rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }
        .problem-box { background: #fff5f5; border-left: 5px solid #e74c3c; }
        .solution-box { background: #f0f9ff; border-left: 5px solid #3498db; }
        
        .problem-box h3 { color: #c0392b; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 10px; }
        .solution-box h3 { color: #2980b9; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 10px; }

        /* ===== GRIDS ===== */
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; }
        .grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.5rem; }

        /* ===== CAROUSEL / CARDS ===== */
        .card-container {
            display: flex; 
            gap: 0; 
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            scroll-behavior: smooth;
            width: 100vw;
            margin-left: calc(-50vw + 50%);
            padding: 0;
        }
        
        .card-container::-webkit-scrollbar {
            height: 8px;
        }
        .card-container::-webkit-scrollbar-track {
            background: #ecf0f1;
            border-radius: 10px;
        }
        .card-container::-webkit-scrollbar-thumb {
            background: #3498db;
            border-radius: 10px;
        }
        
        .info-card {
            flex: 0 0 100vw;
            background: white; 
            padding: 3rem 2rem;
            scroll-snap-align: start;
            scroll-snap-stop: always;
            min-height: auto;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            box-shadow: inset -1px 0 0 0 #e1e1e1;
            overflow-x: hidden;
        }
        .info-card h4 { 
            font-size: 1.5rem; 
            margin-bottom: 1rem; 
            color: #2c3e50;
            text-align: center;
        }
        .info-card > p {
            font-size: 0.95rem;
            text-align: center;
            max-width: 85vw;
            line-height: 1.6;
            color: #555;
            margin-bottom: 2rem;
        }
        .card-diagram {
            flex: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            max-width: 90vw;
            margin-top: 1rem;
        }
        .card-diagram .mermaid {
            width: 100%;
            display: flex;
            justify-content: center;
            max-height: 250px;
            overflow: auto;
        }
        .card-diagram svg {
            max-width: 100%;
            height: auto;
        }

        /* ===== DIAGRAM BOX ===== */
        .diagram-box {
            background: white; padding: 2rem; border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1); margin: 2rem 0;
            overflow: hidden; border: 1px solid #eee;
        }
        .mermaid { display: flex; justify-content: center; margin-top: 1rem; }

        /* ===== TOC HERO ===== */
        #toc {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white; padding: 6rem 2rem; text-align: center;
        }
        #toc h2 { color: white; margin-bottom: 1rem; }
        #toc h2::after { background: white; }
        .toc-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem; margin-top: 3rem;
        }
        .toc-item {
            background: rgba(255,255,255,0.1); padding: 1.5rem; border-radius: 12px;
            backdrop-filter: blur(5px); transition: transform 0.3s, background 0.3s;
            cursor: pointer; text-decoration: none; color: white; border: 1px solid rgba(255,255,255,0.2);
        }
        .toc-item:hover { transform: translateY(-5px); background: rgba(255,255,255,0.2); }
        .toc-item strong { display: block; font-size: 1.2rem; margin-bottom: 0.5rem; }

        /* ===== FOOTER ===== */
        footer {
            background: #2c3e50; color: white; text-align: center; padding: 3rem;
            margin-top: auto;
        }

        /* RESPONSIVE */
        @media (max-width: 768px) {
            .grid-2, .grid-3 { grid-template-columns: 1fr; }
            h2 { font-size: 2rem; }
            nav { display: none; } /* Mobile menu simplified */
        }

        /* ===== MODAL / FULLSCREEN ===== */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.95);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease-in-out;
        }

        .modal.active {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            position: relative;
            max-width: 95%;
            max-height: 95%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-img {
            max-width: 100%;
            max-height: 90vh;
            object-fit: contain;
            border-radius: 8px;
        }

        .modal-mermaid {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            width: 90vw;
            height: 90vh;
            overflow: auto;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-mermaid svg {
            width: 100% !important;
            height: 100% !important;
            max-width: none !important;
            max-height: none !important;
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 30px;
            font-size: 2rem;
            color: white;
            cursor: pointer;
            z-index: 2001;
            transition: transform 0.2s;
            background: rgba(0, 0, 0, 0.5);
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-close:hover {
            transform: scale(1.2);
            background: rgba(0, 0, 0, 0.8);
        }

        .clickable-img, .clickable-mermaid {
            cursor: pointer;
            transition: filter 0.2s;
        }

        .clickable-img:hover {
            filter: brightness(1.1);
        }

        .clickable-mermaid:hover {
            filter: brightness(0.95);
        }

        /* ===== ANIMATIONS ===== */
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        #codeTitle:hover {
            color: #3498db;
        }
    </style>
</head>
<body>

    <!-- HEADER -->
    <header>
        <div class="header-container">
            <div class="logo">Depth - <span>Aware</span></div>
            <nav>
                <ul>
                    <li><a href="#paper">V·∫•n ƒë·ªÅ</a></li>
                    <li><a href="#model">M√¥ h√¨nh</a></li>
                    <li><a href="#arch">Ki·∫øn tr√∫c</a></li>
                    <li><a href="#bigdata">Big Data</a></li>
                    <li><a href="#implementation">Th·ª±c hi·ªán</a></li>
                </ul>
            </nav>
        </div>
    </header>
    <div class="progress-bar"></div>

    <!-- Modal for fullscreen view -->
    <div id="modal" class="modal">
        <button class="modal-close" onclick="closeModal()">&times;</button>
        <div class="modal-content" id="modalContent"></div>
    </div>

    <main>
        <!-- HERO / TOC -->
        <section id="toc">
            <div class="section-content">
                <h2>X·ª≠ l√Ω d·ªØ li·ªáu l·ªõn v·ªõi k·ªπ thu·∫≠t Nh·∫≠n th·ª©c ƒë·ªô s√¢u</h2>
                <p style="font-size: 1.2rem; opacity: 0.9;">Zero-Shot Depth-Aware Image Editing with Diffusion Models</p>
                
                <div class="toc-grid">
                    <a href="#paper" class="toc-item">
                        <strong>V·∫•n ƒê·ªÅ</strong>
                        <span>H·∫°n ch·∫ø hi·ªán t·∫°i & Gi·∫£i ph√°p Zero-shot</span>
                    </a>
                    <a href="#model" class="toc-item">
                        <strong>C√°c Th√†nh Ph·∫ßn</strong>
                        <span>Diffusion + Depth + Identity</span>
                    </a>
                    <a href="#arch" class="toc-item">
                        <strong>Ki·∫øn Tr√∫c</strong>
                        <span>DeGLaD & FeatGLaC Modules</span>
                    </a>
                    <a href="#bigdata" class="toc-item">
                        <strong>Big Data</strong>
                        <span>X·ª≠ l√Ω song song tr√™n Kaggle</span>
                    </a>
                </div>
            </div>
        </section>

        <!-- SECTION 1: V·∫§N ƒê·ªÄ -->
<section id="paper">
            <div class="section-content">
                <h2>T·ªïng Quan & ƒê·ªãnh Nghƒ©a V·∫•n ƒê·ªÅ</h2>
                
                <div class="solution-box" style="background: #fff; border-left: 5px solid #8e44ad; margin-bottom: 2rem;">
                    <h3><i class="fa-solid fa-book-open"></i> C√°c Kh√°i Ni·ªám C·ªët L√µi</h3>
                    <div class="grid-2" style="margin-top: 1rem;">
                        <div>
                            <strong style="color: #8e44ad;">1. Zero-Shot Learning:</strong>
                            <p style="font-size: 0.95rem; margin-top: 0.5rem;">
                                L√† kh·∫£ nƒÉng m√¥ h√¨nh th·ª±c hi·ªán nhi·ªám v·ª• m√† <em>kh√¥ng c·∫ßn hu·∫•n luy·ªán l·∫°i (training-free)</em> tr√™n d·ªØ li·ªáu m·ªõi.
                                <br/>‚ûî <strong>L·ª£i √≠ch:</strong> Ti·∫øt ki·ªám t√†i nguy√™n t√≠nh to√°n (GPU), tri·ªÉn khai nhanh ch√≥ng.
                            </p>
                        </div>
                        <div>
                            <strong style="color: #8e44ad;">2. Depth-Aware (Nh·∫≠n th·ª©c ƒë·ªô s√¢u):</strong>
                            <p style="font-size: 0.95rem; margin-top: 0.5rem;">
                                Kh·∫£ nƒÉng hi·ªÉu c·∫•u tr√∫c kh√¥ng gian 3D c·ªßa ·∫£nh (g·∫ßn/xa), thay v√¨ ch·ªâ x·ª≠ l√Ω tr√™n m·∫∑t ph·∫≥ng 2D (pixels).
                                <br/>‚ûî <strong>M·ª•c ti√™u:</strong> Gi·ªØ ƒë√∫ng quy lu·∫≠t v·∫≠t l√Ω khi ch√®n v·∫≠t th·ªÉ.
                            </p>
                        </div>
                    </div>
                </div>

                <div class="grid-2">
                    <div class="problem-box">
                        <h3><i class="fa-solid fa-triangle-exclamation"></i> H·∫°n Ch·∫ø C·ªßa SOTA (Stable Diffusion)</h3>
                        <p>C√°c m√¥ h√¨nh khu·∫øch t√°n (Diffusion Models) hi·ªán t·∫°i r·∫•t m·∫°nh m·∫Ω nh∆∞ng g·∫∑p l·ªói nghi√™m tr·ªçng v·ªÅ kh√¥ng gian:</p>
                        <ul style="margin-left: 1.5rem; margin-top: 0.5rem; font-size: 0.95rem;">
                            <li><strong>M·∫•t c·∫•u tr√∫c 3D:</strong> Khi ch√®n v·∫≠t th·ªÉ m·ªõi, model th∆∞·ªùng "d√°n ƒë√®" l√™n m·ªçi th·ª© thay v√¨ ƒë·∫∑t n√≥ ra sau v·∫≠t c·∫£n.</li>
                            <li><strong>L·ªói Che Khu·∫•t (Occlusion Error):</strong> Kh√¥ng x·ª≠ l√Ω ƒë∆∞·ª£c tr∆∞·ªùng h·ª£p v·∫≠t th·ªÉ m·ªõi b·ªã v·∫≠t th·ªÉ c≈© che khu·∫•t m·ªôt ph·∫ßn.</li>
                            <li><strong>Thi·∫øu nh·∫•t qu√°n:</strong> √Ånh s√°ng v√† b√≥ng ƒë·ªï kh√¥ng kh·ªõp v·ªõi ƒë·ªô s√¢u c·ªßa c·∫£nh.</li>
                        </ul>
                    </div>
                    
                    <div class="solution-box">
                        <h3><i class="fa-solid fa-check-circle"></i> Gi·∫£i Ph√°p ƒê·ªÅ Xu·∫•t</h3>
                        <p>M·ªôt pipeline ch·ªânh s·ª≠a ·∫£nh <strong>Zero-Shot</strong> s·ª≠ d·ª•ng th√¥ng tin ƒë·ªô s√¢u ƒë·ªÉ h∆∞·ªõng d·∫´n qu√° tr√¨nh sinh ·∫£nh:</p>
                        <ul style="margin-left: 1.5rem; margin-top: 0.5rem; font-size: 0.95rem;">
                            <li><strong>DeGLaD Module:</strong> Ph√¢n t√°ch ·∫£nh th√†nh c√°c l·ªõp (Layers) d·ª±a tr√™n b·∫£n ƒë·ªì ƒë·ªô s√¢u (Depth Map).</li>
                            <li><strong>FeatGLaC Module:</strong> Gh√©p n·ªëi c√°c ƒë·∫∑c tr∆∞ng (Features) l·∫°i v·ªõi nhau ƒë·ªÉ t·∫°o ra ·∫£nh ho√†n ch·ªânh, ƒë·∫£m b·∫£o v·∫≠t th·ªÉ ƒë∆∞·ª£c ch√®n ƒë√∫ng v·ªã tr√≠ kh√¥ng gian.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>
        <!-- SECTION 2: M√î H√åNH -->
        <section id="model">
            <div class="section-content" style="max-width: 100%; width: 100%;">
                <h2>C√°c Th√†nh Ph·∫ßn C·ªët L√µi</h2>
               
                <!-- Tabbed Interface -->
                <div style="position: relative; max-width: 100%; width: 100%; margin: 0 auto;">
                    <!-- Tab Buttons -->
                    <div style="display: flex; gap: 0.5rem; border-bottom: 2px solid #ecf0f1; margin-bottom: 2rem; flex-wrap: wrap;">
                        <button class="model-tab-btn" onclick="showModelTab(0)" style="padding: 1rem 1.5rem; border: none; background: #3498db; color: white; border-radius: 8px 8px 0 0; cursor: pointer; font-weight: 600; transition: background 0.3s; font-size: 0.95rem;">
                            üìä Overall Process
                        </button>
                        <button class="model-tab-btn" onclick="showModelTab(1)" style="padding: 1rem 1.5rem; border: none; background: #95a5a6; color: white; border-radius: 8px 8px 0 0; cursor: pointer; font-weight: 600; transition: background 0.3s; font-size: 0.95rem;">
                            üìê Depth Estimation
                        </button>
                    </div>

                    <!-- Tab 1: Overall Process -->
                    <div class="model-tab-content" id="model-tab-0" style="display: flex; gap: 2rem; align-items: flex-start; padding: 2rem; background: white; border-radius: 12px; min-height: 45vh;">
                        <!-- Image Column -->
                        <div style="flex: 1; min-width: 300px; display: flex; justify-content: center; align-items: center;">
                            <img src="diffusionmodel.png" class="clickable-img" style="max-width: 100%; height: auto; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);" alt="Overall Process">
                        </div>
                        <!-- Text Column -->
                        <div style="flex: 1; min-width: 300px; line-height: 1.8;">
                            <h3 style="color: #2c3e50; margin-top: 0; font-size: 1.3rem; margin-bottom: 1.5rem;">End-to-End Pipeline</h3>
                            <div style="background: #f0f9ff; padding: 1.2rem; border-radius: 8px; border-left: 5px solid #3498db; margin-bottom: 1rem;">
                                <h4 style="color: #2980b9; margin-bottom: 0.7rem; font-size: 1rem;">üì• Step 1: Input Preparation</h4>
                                <ul style="margin: 0; padding-left: 1.5rem; list-style: none; font-size: 0.9rem;">
                                    <li>‚úì Reference Object ‚Üí AnyDoor Encoder ‚Üí Feature embedding</li>
                                    <li>‚úì Scene Image ‚Üí Depth Estimator ‚Üí Depth map</li>
                                    <li>‚úì Scene Image ‚Üí VAE Encoder ‚Üí Latent representation</li>
                                </ul>
                            </div>
                            <div style="background: #f9f0ff; padding: 1.2rem; border-radius: 8px; border-left: 5px solid #9b59b6; margin-bottom: 1rem;">
                                <h4 style="color: #8e44ad; margin-bottom: 0.7rem; font-size: 1rem;">‚öôÔ∏è Step 2: Iterative Denoising</h4>
                                <ul style="margin: 0; padding-left: 1.5rem; list-style: none; font-size: 0.9rem;">
                                    <li>‚úì U-Net removes noise iteratively</li>
                                    <li>‚úì DeGLaD mask guides FG/BG separation</li>
                                    <li>‚úì Latent blending based on depth</li>
                                </ul>
                            </div>
                            <div style="background: #fff0f5; padding: 1.2rem; border-radius: 8px; border-left: 5px solid #e91e63;">
                                <h4 style="color: #c2185b; margin-bottom: 0.7rem; font-size: 1rem;">üì§ Step 3: Final Image</h4>
                                <ul style="margin: 0; padding-left: 1.5rem; list-style: none; font-size: 0.9rem;">
                                    <li>‚úì Latent ‚Üí VAE Decoder ‚Üí Output (512√ó512)</li>
                                    <li>‚úì Follows prompt + preserves depth</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Tab 2: Depth Estimation -->
                    <div class="model-tab-content" id="model-tab-1" style="display: none; gap: 2rem; align-items: flex-start; padding: 2rem; background: white; border-radius: 12px; min-height: 45vh;">
                        <!-- Image Column -->
                        <div style="flex: 1; min-width: 300px; display: flex; justify-content: center; align-items: center;">
                            <img src="depth.jpg" class="clickable-img" style="max-width: 100%; height: auto; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);" alt="Depth Estimation">
                        </div>
                        <!-- Text Column -->
                        <div style="flex: 1; min-width: 300px; line-height: 1.8;">
                            <h3 style="color: #2c3e50; margin-top: 0; font-size: 1.3rem; margin-bottom: 1.5rem;">Depth Anything Module</h3>
                            <div style="background: #f0f9ff; padding: 1.2rem; border-radius: 8px; border-left: 5px solid #3498db; margin-bottom: 1rem;">
                                <h4 style="color: #2980b9; margin-bottom: 0.7rem; font-size: 1rem;">üìä Model</h4>
                                <p style="margin: 0; color: #333; font-size: 0.9rem;">
                                    Zero-shot depth estimator trained on millions of unlabeled images. Generalizes well across diverse scenes.
                                </p>
                            </div>
                            <div style="background: #f9f0ff; padding: 1.2rem; border-radius: 8px; border-left: 5px solid #9b59b6; margin-bottom: 1rem;">
                                <h4 style="color: #8e44ad; margin-bottom: 0.7rem; font-size: 1rem;">üîç Pipeline</h4>
                                <ul style="margin: 0; padding-left: 1.5rem; list-style: none; font-size: 0.9rem;">
                                    <li>‚úì <strong>Preprocessing:</strong> Resize ‚Üí (518, 518)</li>
                                    <li>‚úì <strong>Encoder (DINOv2 ViT):</strong> Multi-level features</li>
                                    <li>‚úì <strong>Decoder (DPT):</strong> Progressive refinement</li>
                                    <li>‚úì <strong>Postprocessing:</strong> Output (H, W)</li>
                                </ul>
                            </div>
                            <div style="background: #fff0f5; padding: 1.2rem; border-radius: 8px; border-left: 5px solid #e91e63;">
                                <h4 style="color: #c2185b; margin-bottom: 0.7rem; font-size: 1rem;">üí° Benefits</h4>
                                <ul style="margin: 0; padding-left: 1.5rem; list-style: none; font-size: 0.9rem;">
                                    <li>‚úì 3D Understanding: object distance</li>
                                    <li>‚úì Occlusion Handling: visibility</li>
                                    <li>‚úì Perspective Preservation: realism</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 3: KI·∫æN TR√öC -->
        <section id="arch">
            <div class="section-content">
                <h2>Ki·∫øn Tr√∫c H·ªá Th·ªëng</h2>
               
                <!-- Tabbed Interface -->
                <div style="position: relative; max-width: 100%; width: 100%; margin: 0 auto;">
                    <!-- Tab Buttons -->
                    <div style="display: flex; gap: 0.5rem; border-bottom: 2px solid #ecf0f1; margin-bottom: 2rem; flex-wrap: wrap;">
                        <button class="arch-tab-btn" onclick="showArchTab(0)" style="padding: 1rem 1.5rem; border: none; background: #27ae60; color: white; border-radius: 8px 8px 0 0; cursor: pointer; font-weight: 600; transition: background 0.3s; font-size: 0.95rem;">
                            üîµ DeGLaD
                        </button>
                        <button class="arch-tab-btn" onclick="showArchTab(1)" style="padding: 1rem 1.5rem; border: none; background: #95a5a6; color: white; border-radius: 8px 8px 0 0; cursor: pointer; font-weight: 600; transition: background 0.3s; font-size: 0.95rem;">
                            üü° FeatGLaC
                        </button>
                    </div>

                    <!-- Tab 1: DeGLaD -->
                    <div class="arch-tab-content" id="arch-tab-0" style="display: flex; gap: 2rem; align-items: flex-start; padding: 2rem; background: white; border-radius: 12px; min-height: 45vh;">
                        <!-- Image Column -->
                        <div style="flex: 1; min-width: 300px; display: flex; justify-content: center; align-items: center;">
                            <img src="deglad.jpg" class="clickable-img" style="max-width: 100%; height: auto; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);" alt="DeGLaD">
                        </div>
                        <!-- Text Column -->
                        <div style="flex: 1; min-width: 300px; line-height: 1.8;">
                            <h3 style="color: #2c3e50; margin-top: 0; font-size: 1.3rem; margin-bottom: 1.5rem;">DeGLaD: Layer Decomposition</h3>
                            <div style="background: #f0f9ff; padding: 1.2rem; border-radius: 8px; border-left: 5px solid #3498db; margin-bottom: 1rem;">
                                <h4 style="color: #2980b9; margin-bottom: 0.7rem; font-size: 1rem;">üéØ Purpose</h4>
                                <p style="margin: 0; color: #333; font-size: 0.9rem;">
                                    Use depth map to separate image into Foreground (near objects) and Background (distant areas).
                                </p>
                            </div>

                            <div style="background: #fff9e6; padding: 1.2rem; border-radius: 8px; border-left: 5px solid #f39c12; margin-bottom: 1rem;">
                                <h4 style="color: #d68910; margin-bottom: 0.7rem; font-size: 1rem;">‚öôÔ∏è Process</h4>
                                <ul style="margin: 0; padding-left: 1.5rem; list-style: none; font-size: 0.9rem;">
                                    <li>‚úì <strong>Threshold:</strong> Compare Z(x,y) with depth threshold d</li>
                                    <li>‚úì <strong>Morphological:</strong> Erosion/dilation for cleanup</li>
                                    <li>‚úì <strong>Output:</strong> M_fg, M_bg masks</li>
                                </ul>
                            </div>

                            <div style="background: #e8f5e9; padding: 1.2rem; border-radius: 8px; border-left: 5px solid #27ae60;">
                                <h4 style="color: #1b5e20; margin-bottom: 0.7rem; font-size: 1rem;">‚ú® Applications</h4>
                                <ul style="margin: 0; padding-left: 1.5rem; list-style: none; font-size: 0.9rem;">
                                    <li>‚úì Add new object: regenerate FG only</li>
                                    <li>‚úì Change background: regenerate BG only</li>
                                    <li>‚úì Maintains 3D consistency</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Tab 2: FeatGLaC -->
                    <div class="arch-tab-content" id="arch-tab-1" style="display: none; gap: 2rem; align-items: flex-start; padding: 2rem; background: white; border-radius: 12px; min-height: 45vh;">
                        <!-- Image Column -->
                        <div style="flex: 1; min-width: 300px; display: flex; justify-content: center; align-items: center;">
                            <img src="featglac.jpg" class="clickable-img" style="max-width: 100%; height: auto; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);" alt="FeatGLaC">
                        </div>
                        <!-- Text Column -->
                        <div style="flex: 1; min-width: 300px; line-height: 1.8;">
                            <h3 style="color: #2c3e50; margin-top: 0; font-size: 1.3rem; margin-bottom: 1.5rem;">FeatGLaC: Feature Compositing</h3>
                            <div style="background: #f0f9ff; padding: 1.2rem; border-radius: 8px; border-left: 5px solid #3498db; margin-bottom: 1rem;">
                                <h4 style="color: #2980b9; margin-bottom: 0.7rem; font-size: 1rem;">üéØ Purpose</h4>
                                <p style="margin: 0; color: #333; font-size: 0.9rem;">
                                    Extract features (textures, colors) from FG/BG to guide image generation with consistent style.
                                </p>
                            </div>

                            <div style="background: #fff9e6; padding: 1.2rem; border-radius: 8px; border-left: 5px solid #f39c12; margin-bottom: 1rem;">
                                <h4 style="color: #d68910; margin-bottom: 0.7rem; font-size: 1rem;">‚öôÔ∏è Parallel Branches</h4>
                                <ul style="margin: 0; padding-left: 1.5rem; list-style: none; font-size: 0.9rem;">
                                    <li>‚úì <strong>Guidance:</strong> VAE encodes FG/BG ‚Üí K, V embeddings</li>
                                    <li>‚úì <strong>Generation:</strong> U-Net denoises from noise (30-50 steps)</li>
                                    <li>‚úì <strong>Cross-Attention:</strong> Injects reference features</li>
                                </ul>
                            </div>

                            <div style="background: #e8f5e9; padding: 1.2rem; border-radius: 8px; border-left: 5px solid #27ae60;">
                                <h4 style="color: #1b5e20; margin-bottom: 0.7rem; font-size: 1rem;">‚ú® Benefits</h4>
                                <ul style="margin: 0; padding-left: 1.5rem; list-style: none; font-size: 0.9rem;">
                                    <li>‚úì Texture Consistency: reuses original patterns</li>
                                    <li>‚úì Color Harmony: matches ambient colors</li>
                                    <li>‚úì Lighting Match: respects illumination</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 4: BIG DATA -->
<section id="bigdata">
    <div class="section-content">
        <h2>X·ª≠ L√Ω Big Data & GPU Ph√¢n T√°n</h2>
        
        <!-- ============ GIAI ƒêO·∫†N 1 ============ -->
        <div style="margin-bottom: 3rem;">
            <h3 style="color: #2980b9; border-bottom: 3px solid #2980b9; padding-bottom: 1rem; margin-bottom: 2rem;">
                <i class="fa-solid fa-brain"></i> Giai ƒêo·∫°n 1: Depth Map Extraction (Training)
            </h3>

            <div class="problem-box" style="margin-bottom: 1.5rem;">
                <h4 style="color: #c0392b; margin-bottom: 0.8rem;">üìå B√†i To√°n</h4>
                <p>X·ª≠ l√Ω 100,000 ·∫£nh (~10GB) ƒë·ªÉ t√≠nh depth map b·∫±ng m√¥ h√¨nh <strong>Depth Anything</strong> tr√™n multi-GPU Kaggle.</p>
            </div>

            <div style="background: #f0f9ff; padding: 1.5rem; border-radius: 12px; border-left: 5px solid #3498db; margin-bottom: 1.5rem;">
                <h4 style="color: #2980b9; margin-bottom: 0.8rem;">üîß Gi·∫£i Ph√°p: Spark MapPartitions</h4>
                <ul style="list-style-position: inside; line-height: 1.8; color: #333;">
                    <li><strong>Repartition:</strong> 40 partitions ‚Üí load balancing tr√™n 2 GPU</li>
                    <li><strong>Per-Partition Model:</strong> M·ªói GPU kh·ªüi t·∫°o 1 model Depth Anything</li>
                    <li><strong>Batch Processing:</strong> 16 ·∫£nh/batch ‚Üí t·ªëi ∆∞u VRAM</li>
                    <li><strong>Desync:</strong> Random sleep 0.5-3s tr√°nh GPU deadlock</li>
                    <li><strong>Output:</strong> Depth map PNG lossless cho m·ªói ·∫£nh</li>
                </ul>
            </div>

            <!-- H√¨nh ·∫£nh Stage 1 -->
            <div style="text-align: center; margin-top: 1.5rem; margin-bottom: 2rem;">
                <img src="bigdata1.jpg" alt="Stage 1 Training" class="clickable-img" 
                     style="max-width: 100%; height: auto; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); cursor: pointer; transition: transform 0.3s;">
            </div>
        </div>

        <!-- ============ GIAI ƒêO·∫†N 2 ============ -->
        <div style="margin-bottom: 2rem;">
            <h3 style="color: #27ae60; border-bottom: 3px solid #27ae60; padding-bottom: 1rem; margin-bottom: 2rem;">
                <i class="fa-solid fa-wand-magic-sparkles"></i> Giai ƒêo·∫°n 2: Depth-Aware Editing (Inference)
            </h3>

            <div class="problem-box" style="margin-bottom: 1.5rem;">
                <h4 style="color: #c0392b; margin-bottom: 0.8rem;">üìå M·ª•c ƒê√≠ch</h4>
                <p>S·ª≠ d·ª•ng depth map t·ª´ Giai ƒêo·∫°n 1 ƒë·ªÉ h∆∞·ªõng d·∫´n qu√° tr√¨nh sinh ·∫£nh qua 3 module: <strong>DEGLAD, FEATGLAC, Diffusion</strong>.</p>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1.5rem; margin-bottom: 1.5rem;">
                <div style="background: #f0f9ff; padding: 1.2rem; border-radius: 8px; border-left: 4px solid #3498db;">
                    <h5 style="color: #2980b9; margin-bottom: 0.6rem;">üîµ DEGLAD</h5>
                    <p style="margin: 0; font-size: 0.9rem; color: #333;">T√°ch ·∫£nh th√†nh Foreground + Background d·ª±a depth mask</p>
                </div>
                <div style="background: #fff9e6; padding: 1.2rem; border-radius: 8px; border-left: 4px solid #f39c12;">
                    <h5 style="color: #d68910; margin-bottom: 0.6rem;">üü° FEATGLAC</h5>
                    <p style="margin: 0; font-size: 0.9rem; color: #333;">Tr√≠ch feature (texture, color) t·ª´ m·ªói l·ªõp</p>
                </div>
                <div style="background: #e8f5e9; padding: 1.2rem; border-radius: 8px; border-left: 4px solid #27ae60;">
                    <h5 style="color: #1b5e20; margin-bottom: 0.6rem;">üü¢ Diffusion</h5>
                    <p style="margin: 0; font-size: 0.9rem; color: #333;">Sinh ·∫£nh v·ªõi text + depth + feature guidance</p>
                </div>
            </div>

            <div style="background: #fff9e6; padding: 1.5rem; border-radius: 12px; border-left: 5px solid #f39c12;">
                <h4 style="color: #d68910; margin-bottom: 0.8rem;">‚öôÔ∏è End-to-End Pipeline</h4>
                <ol style="margin: 0; padding-left: 1.5rem; color: #333; font-size: 0.95rem; line-height: 1.8;">
                    <li>Input: RGB ·∫£nh + text prompt</li>
                    <li>Depth Extraction ‚Üí Depth map (t·ª´ Giai ƒêo·∫°n 1)</li>
                    <li>DEGLAD t√°ch Foreground/Background</li>
                    <li>FEATGLAC tr√≠ch features t·ª´ 2 l·ªõp</li>
                    <li>Diffusion sinh ·∫£nh m·ªõi (text + depth + features)</li>
                    <li>Output: ·∫¢nh ch·ªânh s·ª≠a v·ªõi 3D consistency</li>
                </ol>
            </div>

            <!-- H√¨nh ·∫£nh Stage 2 -->
            <div style="text-align: center; margin-top: 2rem;">
                <img src="bigdata.jpg" alt="Stage 2 Pipeline" class="clickable-img" 
                     style="max-width: 100%; height: auto; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); cursor: pointer; transition: transform 0.3s;">
            </div>
        </div>
    </div>
</section>

<!-- SECTION 5: INTERACTIVE CODE -->
<section id="code">
    <div class="section-content">
        <h2 id="codeTitle" style="cursor: pointer; user-select: none; transition: color 0.3s; margin-bottom: 0;">
            üìã M√£ Ngu·ªìn & Th·ª±c Hi·ªán
        </h2>
        
        <!-- Code Demo Container - Below Title, Full Width -->
        <div id="codeContainer" style="
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.6s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.6s ease;
            opacity: 0;
            margin-top: 1rem;
        ">
            <!-- Code Snippet - MapReduce run_job() -->
            <div id="codeSnippet" style="background: #2c3e50; padding: 2rem; border-radius: 12px; margin-bottom: 1.5rem; animation: slideInUp 0.6s ease 0.1s forwards; opacity: 0; transition: transform 0.3s, box-shadow 0.3s;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <h4 style="color: white; margin: 0; font-size: 1.05rem;">
                        üîç MapReduce Job - run_job() Function
                    </h4>
                    <button onclick="window.open('https://www.kaggle.com/code/hongtptrai/big-data', '_blank');" style="background: #3498db; color: white; border: none; padding: 0.5rem 1rem; border-radius: 6px; cursor: pointer; font-size: 0.85rem; font-weight: 600; transition: background 0.3s;">
                        üîó View on Kaggle
                    </button>
                </div>
                <pre style="background: #1a252f; color: #a8e6cf; padding: 1.5rem; border-radius: 8px; overflow-x: auto; font-size: 0.7rem; line-height: 1.4; margin: 0;">
<span style="color: #ffd3b6;">def</span> <span style="color: #ffadb5;">run_job</span>():    
    <span style="color: #ffd3b6;">import</span> random
    <span style="color: #ffd3b6;">from</span> pyspark.sql <span style="color: #ffd3b6;">import</span> SparkSession
    <span style="color: #ffd3b6;">from</span> pyspark.sql.functions <span style="color: #ffd3b6;">import</span> col    
    <span style="color: #ffd3b6;">try</span>: SparkSession.getActiveSession().stop()
    <span style="color: #ffd3b6;">except</span>: <span style="color: #ffd3b6;">pass</span>

    spark = SparkSession.builder \
        .master(<span style="color: #a8d8ea;">"local[2]"</span>) \
        .appName(<span style="color: #a8d8ea;">"Depth_Inference_Test_Set"</span>) \
        .config(<span style="color: #a8d8ea;">"spark.driver.memory"</span>, <span style="color: #a8d8ea;">"4g"</span>) \
        .config(<span style="color: #a8d8ea;">"spark.executor.memory"</span>, <span style="color: #a8d8ea;">"4g"</span>) \
        .getOrCreate()
    
    df = spark.read.format(<span style="color: #a8d8ea;">"binaryFile"</span>) \
        .load(CONFIG_INPUT) \
        .filter(col(<span style="color: #a8d8ea;">"path"</span>).like(<span style="color: #a8d8ea;">"%_colors.png"</span>))
    
    NUM_PARTITIONS = 20 
    partitioned_rdd = df.rdd.map(...).partitionBy(NUM_PARTITIONS)
    
    <span style="color: #ffd3b6;">try</span>:
        count = partitioned_rdd.mapPartitions(reduce_process_partition).count()
        <span style="color: #ffd3b6;">print</span>(<span style="color: #a8d8ea;">f"‚úÖ Processed: {count} images"</span>)
    <span style="color: #ffd3b6;">except</span> Exception <span style="color: #ffd3b6;">as</span> e:
        <span style="color: #ffd3b6;">print</span>(<span style="color: #a8d8ea;">f"‚ùå JOB FAILED: {e}"</span>)
    
    spark.stop()
                </pre>
            </div>

            <!-- Key Points Box -->
            <div style="background: #f0f9ff; padding: 1.5rem; border-radius: 12px; border-left: 5px solid #3498db; animation: slideInUp 0.6s ease 0.2s forwards; opacity: 0;">
                <h4 style="color: #2980b9; margin-bottom: 0.8rem; margin-top: 0;">üí° Implementation Details</h4>
                <ul style="margin: 0; padding-left: 1.5rem; color: #333; line-height: 1.8; font-size: 0.95rem;">
                    <li><strong>Handle Missing Images:</strong> Fallback to zeros if image load fails</li>
                    <li><strong>RGB Conversion:</strong> BGR ‚Üí RGB (OpenCV uses BGR by default)</li>
                    <li><strong>Depth Normalization:</strong> NYU dataset (mm scale) ‚Üí 0-1 range to prevent loss explosion</li>
                    <li><strong>Transform & Return:</strong> Apply ImageNet transforms, return (image_tensor, depth_tensor) pair</li>
                </ul>
            </div>
        </div>

    </div>
</section>

<!-- SECTION 6: REFERENCES -->
<section id="references">
    <div class="section-content">
        <h2>T√†i Li·ªáu Tham Kh·∫£o</h2>
        
        <div class="solution-box" style="background: white; border-left: 5px solid #34495e;">
            <h3><i class="fa-solid fa-quote-right"></i> C√°c Nghi√™n C·ª©u N·ªÅn T·∫£ng</h3>
            <div style="display: flex; flex-direction: column; gap: 1rem; margin-top: 1rem;">
                
                <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px; border: 1px solid #eee;">
                    <strong style="color: #2c3e50;">[1] Depth Anything Module</strong>
                    <p style="font-size: 0.9rem; margin-top: 0.3rem;">
                        Lihe Young et al., <em>"Depth Anything: Unleashing the Power of Large-Scale Unlabeled Data,"</em> CVPR 2024. 
                        <br/>
                        <a href="https://github.com/LiheYoung/Depth-Anything" target="_blank" style="color: #3498db; text-decoration: none; font-weight: 600; font-size: 0.85rem;">
                            <i class="fa-brands fa-github"></i> Xem GitHub Repo (Official) ‚ûî
                        </a>
                    </p>
                </div>

                <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px; border: 1px solid #eee;">
                    <strong style="color: #2c3e50;">[2] Latent Diffusion Models (Stable Diffusion)</strong>
                    <p style="font-size: 0.9rem; margin-top: 0.3rem;">
                        Robin Rombach et al., <em>"High-Resolution Image Synthesis with Latent Diffusion Models,"</em> CVPR 2022.
                        <br/>
                        <a href="https://github.com/CompVis/latent-diffusion" target="_blank" style="color: #3498db; text-decoration: none; font-weight: 600; font-size: 0.85rem;">
                            <i class="fa-brands fa-github"></i> Xem GitHub Repo ‚ûî
                        </a>
                    </p>
                </div>

                <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px; border: 1px solid #eee;">
                    <strong style="color: #2c3e50;">[3] DINOv2 Backbone</strong>
                    <p style="font-size: 0.9rem; margin-top: 0.3rem;">
                        Maxime Oquab et al., <em>"DINOv2: Learning Robust Visual Features without Supervision,"</em> arXiv 2023.
                        <br/>
                        <a href="https://github.com/facebookresearch/dinov2" target="_blank" style="color: #3498db; text-decoration: none; font-weight: 600; font-size: 0.85rem;">
                            <i class="fa-brands fa-github"></i> Xem GitHub Repo ‚ûî
                        </a>
                    </p>
                </div>

                <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px; border: 1px solid #eee;">
                    <strong style="color: #2c3e50;">[4] Zero-Shot Image Editing (pix2pix-zero)</strong>
                    <p style="font-size: 0.9rem; margin-top: 0.3rem;">
                        Gaurav Parmar et al., <em>"Zero-Shot Image-to-Image Translation,"</em> SIGGRAPH 2023.
                        <br/>
                        <a href="https://github.com/pix2pixzero/pix2pix-zero" target="_blank" style="color: #3498db; text-decoration: none; font-weight: 600; font-size: 0.85rem;">
                            <i class="fa-brands fa-github"></i> Xem GitHub Repo (Official) ‚ûî
                        </a>
                    </p>
                </div>

            </div>
        </div>
    </div>
</section>

    <footer id="implementation">
        <h3>Zero-Shot Depth-Aware Image Editing</h3>
        <p>B√°o c√°o b√†i t·∫≠p l·ªõn m√¥n h·ªçc Big Data - Nh√≥m 14 - K64HTTT1</p>
        <p style="font-size: 0.9rem; margin-top: 1rem; opacity: 0.7;">Th·ª±c hi·ªán b·ªüi<br/> Ph·∫°m Qu·ªëc H√πng - 2151060248<br/>Nguy·ªÖn VƒÉn S∆°n - 1951060984</p>
    </footer>

    <script>
        // Kh·ªüi t·∫°o Mermaid
        mermaid.initialize({ startOnLoad: true, theme: 'default' });

        // Progress Bar & Active Link Logic
        window.addEventListener('scroll', () => {
            const winScroll = document.documentElement.scrollTop;
            const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrolled = (winScroll / height) * 100;
            document.querySelector('.progress-bar').style.width = scrolled + "%";

            // Active Menu
            const sections = document.querySelectorAll('section');
            const navLinks = document.querySelectorAll('nav a');
            
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                if (window.scrollY >= sectionTop - 150) {
                    current = section.getAttribute('id');
                }
            });

            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href').includes(current)) {
                    link.classList.add('active');
                }
            });
        });

        // Keyboard Navigation cho Carousels
        document.addEventListener('keydown', (e) => {
            if (e.key !== 'ArrowRight' && e.key !== 'ArrowLeft') return;
            
            const modelSection = document.getElementById('model');
            const archSection = document.getElementById('arch');
            const scrollAmount = window.innerWidth + 16;
            
            let carousel = null;
            
            // Check Model Section
            if (modelSection?.offsetParent) {
                const modelRect = modelSection.getBoundingClientRect();
                if (modelRect.top <= window.innerHeight && modelRect.bottom >= 0) {
                    carousel = modelSection.querySelector('#modelCarousel');
                }
            }
            
            // Check Architecture Section
            if (!carousel && archSection?.offsetParent) {
                const archRect = archSection.getBoundingClientRect();
                if (archRect.top <= window.innerHeight && archRect.bottom >= 0) {
                    carousel = archSection.querySelector('#archCarousel');
                }
            }
            
            if (!carousel) return;
            
            e.preventDefault();
            
            if (e.key === 'ArrowRight') {
                carousel.scrollBy({ left: scrollAmount, behavior: 'smooth' });
            } else if (e.key === 'ArrowLeft') {
                carousel.scrollBy({ left: -scrollAmount, behavior: 'smooth' });
            }
        });

        // ===== MODAL FUNCTIONS =====
        function openModal(content, isImage) {
            const modal = document.getElementById('modal');
            const modalContent = document.getElementById('modalContent');
            
            if (isImage) {
                const img = document.createElement('img');
                img.src = content;
                img.className = 'modal-img';
                modalContent.innerHTML = '';
                modalContent.appendChild(img);
            } else {
                // For Mermaid diagrams - fix SVG sizing
                const wrapper = document.createElement('div');
                wrapper.className = 'modal-mermaid';
                wrapper.innerHTML = content;
                
                // Remove width/height constraints from SVG to let it scale
                const svg = wrapper.querySelector('svg');
                if (svg) {
                    svg.removeAttribute('width');
                    svg.removeAttribute('height');
                    svg.style.width = '100%';
                    svg.style.height = '100%';
                }
                
                modalContent.innerHTML = '';
                modalContent.appendChild(wrapper);
            }
            
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            const modal = document.getElementById('modal');
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // Close modal when clicking outside content
        document.getElementById('modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        // Close modal on Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeModal();
            }
        });

        // Add click handlers to all images
        document.addEventListener('DOMContentLoaded', function() {
            const images = document.querySelectorAll('.clickable-img');
            images.forEach(img => {
                img.addEventListener('click', function() {
                    openModal(this.src, true);
                });
            });

            // Add click handlers to Mermaid diagrams
            const mermaidDivs = document.querySelectorAll('.clickable-mermaid');
            mermaidDivs.forEach(div => {
                div.addEventListener('click', function() {
                    const svgContent = this.innerHTML;
                    openModal(svgContent, false);
                });
            });
        });
    </script>

    <!-- ===== CODE SECTION INTERACTIONS ===== -->
    <script>
        let codeRevealed = false;
        const codeTitle = document.getElementById('codeTitle');
        const codeContainer = document.getElementById('codeContainer');
        
        function toggleCode() {
            codeRevealed = !codeRevealed;
            if (codeRevealed) {
                codeContainer.style.maxHeight = '1000px';
                codeContainer.style.opacity = '1';
            } else {
                codeContainer.style.maxHeight = '0';
                codeContainer.style.opacity = '0';
            }
        }
        
        // Hover to show
        if (codeTitle) {
            codeTitle.addEventListener('mouseenter', function() {
                codeContainer.style.maxHeight = '1000px';
                codeContainer.style.opacity = '1';
            });
            
            // Click to toggle sticky
            codeTitle.addEventListener('click', toggleCode);
        }
        
        // Leave to hide (unless clicked)
        const codeSection = document.getElementById('code');
        if (codeSection) {
            codeSection.addEventListener('mouseleave', function() {
                if (!codeRevealed) {
                    codeContainer.style.maxHeight = '0';
                    codeContainer.style.opacity = '0';
                }
            });
        }

        // ===== TAB SWITCHING FUNCTIONS =====
        function showModelTab(tabIndex) {
            // Hide all tabs
            const tabs = document.querySelectorAll('.model-tab-content');
            tabs.forEach(tab => tab.style.display = 'none');
            
            // Show selected tab
            document.getElementById(`model-tab-${tabIndex}`).style.display = 'flex';
            
            // Update button styles
            const buttons = document.querySelectorAll('.model-tab-btn');
            buttons.forEach(btn => btn.style.background = '#95a5a6');
            buttons[tabIndex].style.background = '#3498db';
        }

        function showArchTab(tabIndex) {
            // Hide all tabs
            const tabs = document.querySelectorAll('.arch-tab-content');
            tabs.forEach(tab => tab.style.display = 'none');
            
            // Show selected tab
            document.getElementById(`arch-tab-${tabIndex}`).style.display = 'flex';
            
            // Update button styles
            const buttons = document.querySelectorAll('.arch-tab-btn');
            buttons.forEach(btn => btn.style.background = '#95a5a6');
            buttons[tabIndex].style.background = '#27ae60';
        }
    </script>
</body>
</html>